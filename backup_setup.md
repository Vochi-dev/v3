# üóÑÔ∏è **–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ë–≠–ö–ê–ü POSTGRESQL**

**–î–∞—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** 03.08.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ê–°–¢–†–û–ï–ù –ò –†–ê–ë–û–¢–ê–ï–¢  

---

## üìã **–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø**

### üïí **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:**
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 03:00 –∫–∞–∂–¥—É—é –Ω–æ—á—å
- **Cron –∑–∞–¥–∞—á–∞:** `0 3 * * * /usr/local/bin/postgres-backup.sh >> /var/log/postgres_backup_cron.log 2>&1`

### üìÅ **–§–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
- **–°–∫—Ä–∏–ø—Ç –±—ç–∫–∞–ø–∞:** `/usr/local/bin/postgres-backup.sh`
- **–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –±—ç–∫–∞–ø–æ–≤:** `/root/Backup/`
- **–õ–æ–≥ —Ñ–∞–π–ª:** `/var/log/postgres_backup.log`
- **Cron –ª–æ–≥:** `/var/log/postgres_backup_cron.log`

### üóÉÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
- **–•–æ—Å—Ç:** 127.0.0.1:5432
- **–ë–∞–∑–∞:** postgres
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** postgres
- **–§–æ—Ä–º–∞—Ç:** PostgreSQL Custom (—Å–∂–∞—Ç—ã–π)

---

## ‚öôÔ∏è **–í–û–ó–ú–û–ñ–ù–û–°–¢–ò –°–ö–†–ò–ü–¢–ê**

### ‚úÖ **–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- üîÑ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤** –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.dump`
- üìù **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- üßπ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (>7 –¥–Ω–µ–π)
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** —Ä–∞–∑–º–µ—Ä–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±—ç–∫–∞–ø–æ–≤
- üõ°Ô∏è **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫** –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### üì¶ **–§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞:**
```
postgres_auto_YYYYMMDD_HHMMSS.dump
```

**–ü—Ä–∏–º–µ—Ä:** `postgres_auto_20250803_030001.dump`

---

## üîß **–£–ü–†–ê–í–õ–ï–ù–ò–ï**

### üß™ **–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```bash
/usr/local/bin/postgres-backup.sh
```

### üìã **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:**
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ –±—ç–∫–∞–ø–∞
tail -f /var/log/postgres_backup.log

# –õ–æ–≥–∏ cron –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
tail -f /var/log/postgres_backup_cron.log
```

### üìÅ **–ü—Ä–æ—Å–º–æ—Ç—Ä –±—ç–∫–∞–ø–æ–≤:**
```bash
ls -lah /root/Backup/postgres_auto_*.dump
```

### üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ç–∫–∞–ø–æ–≤:**
```bash
echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—ç–∫–∞–ø–æ–≤: $(ls -1 /root/Backup/postgres_auto_*.dump 2>/dev/null | wc -l)"
echo "–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: $(du -sh /root/Backup 2>/dev/null | cut -f1)"
```

---

## üîÑ **CRON –ó–ê–î–ê–ß–ò –°–ò–°–¢–ï–ú–´**

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–¥–∞—á
crontab -l

# –¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏:
# 0 3 * * * - PostgreSQL –±—ç–∫–∞–ø (03:00)
# 0 9 * * * - SSL –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (09:00)
```

---

## üîß **–ù–ê–°–¢–†–û–ô–ö–ò –ò –ü–ê–†–ê–ú–ï–¢–†–´**

### üóÇÔ∏è **–†–æ—Ç–∞—Ü–∏—è –±—ç–∫–∞–ø–æ–≤:**
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** 7 –¥–Ω–µ–π
- **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞:** –î–∞, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
- **–†—É—á–Ω—ã–µ –±—ç–∫–∞–ø—ã:** –ù–µ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### üíæ **–†–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–æ–≤:**
- **–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä:** ~100MB (—Å–∂–∞—Ç—ã–π —Ñ–æ—Ä–º–∞—Ç)
- **–ú–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ:** ~700MB –¥–ª—è 7 –¥–Ω–µ–π

### üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü–∞—Ä–æ–ª—å –ë–î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –≤ —Å–∫—Ä–∏–ø—Ç–µ
- ‚úÖ –õ–æ–≥–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üö® **–ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê**

### ‚ö†Ô∏è **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø
ls -lt /root/Backup/postgres_auto_*.dump | head -1

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
grep "‚ùå\|ERROR\|–û–®–ò–ë–ö–ê" /var/log/postgres_backup.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞
du -h $(ls -t /root/Backup/postgres_auto_*.dump | head -1)
```

### üîî **–ü—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–æ–±–ª–µ–º:**
- –ù–µ—Ç –Ω–æ–≤—ã—Ö –±—ç–∫–∞–ø–æ–≤ –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤
- –†–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ
- –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö –±—ç–∫–∞–ø–∞
- –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/root/Backup`

---

## üìù **–ò–°–¢–û–†–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô**

### v1.0.0 (03.08.2025)
- ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ cron –∑–∞–¥–∞—á–∞ –Ω–∞ 03:00
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (7 –¥–Ω–µ–π)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã

---

## üéØ **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò**

### üí° **–î–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
1. **–£–¥–∞–ª–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å –æ–±–ª–∞—á–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
2. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3. **–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –±—ç–∫–∞–ø—ã:** –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### üîç **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –±—ç–∫–∞–ø–æ–≤
- –ï–∂–µ–º–µ—Å—è—á–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ

---

*–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∫–∞–∂–¥—É—é –Ω–æ—á—å –≤ 03:00. –í—Å–µ —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π.*