# üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –≤ telegram_users

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä—é–∑–µ—Ä—É —Å chat_id `374573193`. –ß—Ç–æ–±—ã —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ –Ω–∞ –Ω–æ–≤—ã–π chat_id (–Ω–∞–ø—Ä–∏–º–µ—Ä, `989104050`), –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É `telegram_users`.

**‚úÖ –í–ê–ñ–ù–û:** –° –∏—é–ª—è 2025 –≥–æ–¥–∞ –æ–¥–∏–Ω chat_id –º–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ—Ç–æ–≤ (–∏–∑–º–µ–Ω–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î)!

## –®–∞–≥ 1: –£–∑–Ω–∞—Ç—å bot_token –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è
```sql
-- –ó–∞–º–µ–Ω–∏ 'XXXX' –Ω–∞ –Ω–æ–º–µ—Ä –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, '0116')
SELECT number, bot_token FROM enterprises WHERE number = 'XXXX';
```

## –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```sql
-- –ó–∞–º–µ–Ω–∏ 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1' –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
SELECT tg_id, bot_token FROM telegram_users WHERE bot_token = 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1';
```

## –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```sql
-- –ó–∞–º–µ–Ω–∏:
-- XXXXXXXXX - –Ω–∞ chat_id (–Ω–∞–ø—Ä–∏–º–µ—Ä, 989104050)  
-- BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1 - –Ω–∞ bot_token –∏–∑ —à–∞–≥–∞ 1
-- support@example.com - –Ω–∞ –ª—é–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π email (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å)

INSERT INTO telegram_users (tg_id, email, bot_token) VALUES 
(XXXXXXXXX, 'support@example.com', 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1');
```

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```sql
-- –ó–∞–º–µ–Ω–∏ 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1' –Ω–∞ —Ç–æ–∫–µ–Ω –∏–∑ —à–∞–≥–∞ 1
SELECT tg_id, bot_token FROM telegram_users WHERE bot_token = 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1';
```

---

## üîß –ö–æ–º–∞–Ω–¥—ã –¥–ª—è PostgreSQL —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î:
```bash
PGPASSWORD='r/Yskqh/ZbZuvjb2b3ahfg==' psql -U postgres -d postgres
```

### –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤ –æ–¥–Ω–æ–º –±–ª–æ–∫–µ (–∑–∞–º–µ–Ω–∏ –∑–Ω–∞—á–µ–Ω–∏—è):
```sql
-- 1. –£–∑–Ω–∞—Ç—å bot_token
SELECT number, bot_token FROM enterprises WHERE number = 'XXXX';

-- 2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–º–µ–Ω–∏ XXXXXXXXX –∏ BOT_TOKEN)
INSERT INTO telegram_users (tg_id, email, bot_token) VALUES 
(XXXXXXXXX, 'support@example.com', 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1');

-- 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
SELECT tg_id, bot_token FROM telegram_users WHERE bot_token = 'BOT_TOKEN_–ò–ó_–®–ê–ì–ê_1';

-- 4. –í—ã–π—Ç–∏
\q
```

---

## üìù –ü—Ä–∏–º–µ—Ä –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è 0123 —Å chat_id 555666777

```sql
-- 1. –£–∑–Ω–∞—Ç—å —Ç–æ–∫–µ–Ω
SELECT number, bot_token FROM enterprises WHERE number = '0123';
-- –î–æ–ø—É—Å—Ç–∏–º –ø–æ–ª—É—á–∏–ª–∏: 7123456789:AAEexampleTokenHere

-- 2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
INSERT INTO telegram_users (tg_id, email, bot_token) VALUES 
(555666777, 'support@example.com', '7123456789:AAEexampleTokenHere');

-- 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
SELECT tg_id, bot_token FROM telegram_users WHERE bot_token = '7123456789:AAEexampleTokenHere';
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **tg_id** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º (–±–µ–∑ –∫–∞–≤—ã—á–µ–∫)
2. **email** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –≤ –ë–î –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã (tg_id, bot_token)
3. **bot_token** –¥–æ–ª–∂–µ–Ω —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–æ–∫–µ–Ω–æ–º –∏–∑ enterprises
4. **–û–¥–∏–Ω chat_id –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ù–ï–°–ö–û–õ–¨–ö–ò–• –±–æ—Ç–æ–≤** (—Å –∏—é–ª—è 2025)
5. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –ò –≤ –Ω–æ–≤—ã–π chat_id, –ò –≤ —Å—É–ø–µ—Ä—é–∑–µ—Ä–∞ 374573193

---

## üìã –¢–µ–∫—É—â–∏–µ chat_id –≥—Ä—É–ø–ø—ã

- **374573193** ‚Üí —Å—Ç–∞—Ä—ã–µ –±–æ—Ç—ã (—Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ –ª–∏–º–∏—Ç–∞ 40)
- **989104050** ‚Üí –Ω–æ–≤—ã–µ –±–æ—Ç—ã (0116, 0110, 0114, –∏ –¥—Ä—É–≥–∏–µ –¥–æ –ª–∏–º–∏—Ç–∞ 40)
- **–°–ª–µ–¥—É—é—â–∏–π chat_id** ‚Üí –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ 40 –±–æ—Ç–æ–≤

---

## üß™ –¢–µ—Å—Ç –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

```bash
# –ó–∞–º–µ–Ω–∏ TOKEN_ASTERISK –Ω–∞ name2 –∏–∑ enterprises, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –∂–µ–ª–∞–Ω–∏—é
curl -X POST "https://bot.vochi.by/dial" -H "Content-Type: application/json" -d '{"Token": "TOKEN_ASTERISK", "CallType": 1, "UniqueId": "test_dial_XXXX", "ExtPhone": "", "Trunk": "0001363", "Extensions": ["151"], "Phone": "375291234567", "ExtTrunk": ""}'
```

### –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
Found bot_token: YOUR_BOT_TOKEN, tg_ids: [XXXXXXXXX, 374573193]
Successfully sent to chat_id: XXXXXXXXX
```

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ù–∞–π—Ç–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –±–µ–∑ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤:
```sql
SELECT e.number, e.bot_token, COUNT(tu.tg_id) as user_count 
FROM enterprises e 
LEFT JOIN telegram_users tu ON e.bot_token = tu.bot_token 
WHERE e.bot_token IS NOT NULL AND e.bot_token != '' 
GROUP BY e.number, e.bot_token 
HAVING COUNT(tu.tg_id) = 0
ORDER BY CAST(e.number AS INTEGER);
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—é:
```sql
SELECT e.number, e.name, tu.tg_id, tu.email 
FROM enterprises e 
JOIN telegram_users tu ON e.bot_token = tu.bot_token 
WHERE e.number = 'XXXX';
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –±–æ—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ chat_id:
```sql
SELECT e.number, e.name, tu.tg_id, tu.bot_token
FROM telegram_users tu
JOIN enterprises e ON tu.bot_token = e.bot_token
WHERE tu.tg_id = XXXXXXXXX
ORDER BY CAST(e.number AS INTEGER);
```

---

## üìä –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **Asterisk –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ** —Å —Ç–æ–∫–µ–Ω–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `375445561561`)
2. **–°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ** –ø–æ `enterprises.name2 = —Ç–æ–∫–µ–Ω`
3. **–ü–æ–ª—É—á–∞–µ—Ç bot_token** –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è
4. **–ò—â–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤** –≤ `telegram_users.bot_token = bot_token`
5. **–î–æ–±–∞–≤–ª—è–µ—Ç —Å—É–ø–µ—Ä—é–∑–µ—Ä–∞** 374573193 –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ
6. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è** –≤—Å–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–º chat_id

**–ë–µ–∑ –∑–∞–ø–∏—Å–∏ –≤ telegram_users** ‚Üí —Å–æ–æ–±—â–µ–Ω–∏—è –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ –≤ 374573193  
**–° –∑–∞–ø–∏—Å—å—é –≤ telegram_users** ‚Üí —Å–æ–æ–±—â–µ–Ω–∏—è –∏–¥—É—Ç –≤ –Ω–æ–≤—ã–π chat_id + 374573193

**–ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å:** –û–¥–∏–Ω chat_id –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ! 