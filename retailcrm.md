# üìû **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ –¢–ï–õ–ï–§–û–ù–ò–ò –° RETAILCRM**

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 03.08.2025  
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ  

---

## üéØ **–¶–ï–õ–¨ –ü–†–û–ï–ö–¢–ê**

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏ `asterisk-webhook` —Å [RetailCRM](https://docs.retailcrm.ru/Developers/API) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥–∞–∂.

---

## üîç **–ê–ù–ê–õ–ò–ó –í–û–ó–ú–û–ñ–ù–û–°–¢–ï–ô RETAILCRM**

### üìö **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- **API v5:** [https://docs.retailcrm.ru/Developers/API](https://docs.retailcrm.ru/Developers/API)
- **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Ç–æ–¥–æ–≤:** –î–æ—Å—Ç—É–ø–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–∫–∞–∑–∞–º–∏, –∫–ª–∏–µ–Ω—Ç–∞–º–∏, –∑–≤–æ–Ω–∫–∞–º–∏
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ webhook'–æ–≤ –∏ –≤–Ω–µ—à–Ω–∏—Ö API
- **–¢–µ–ª–µ—Ñ–æ–Ω–∏—è:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ê–¢–°

### üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   RetailCRM     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  asterisk.py     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Asterisk      ‚îÇ
‚îÇ   (webhook)     ‚îÇ    ‚îÇ  (API Bridge)    ‚îÇ    ‚îÇ   Hosts         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                        ‚îÇ                       ‚îÇ
        ‚ñº                        ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ö–ª–∏–µ–Ω—Ç—ã/–õ–∏–¥—ã   ‚îÇ    ‚îÇ   PostgreSQL     ‚îÇ    ‚îÇ –ó–∞–ø–∏—Å–∏ –∑–≤–æ–Ω–∫–æ–≤  ‚îÇ
‚îÇ  –ó–∞–∫–∞–∑—ã/–°–¥–µ–ª–∫–∏  ‚îÇ    ‚îÇ   (–ï–¥–∏–Ω–∞—è –ë–î)    ‚îÇ    ‚îÇ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üöÄ **–≠–¢–ê–ü–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò**

### üìã **–≠–¢–ê–ü 1: –ü–û–î–ì–û–¢–û–í–ö–ê (1-2 –¥–Ω—è)**

#### ‚úÖ **1.1 –ò–∑—É—á–µ–Ω–∏–µ RetailCRM API**
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç RetailCRM
- [ ] –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [ ] –ò–∑—É—á–∏—Ç—å –º–µ—Ç–æ–¥—ã API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å:
  - –ö–ª–∏–µ–Ω—Ç–∞–º–∏ (`/api/v5/customers`)
  - –ó–∞–∫–∞–∑–∞–º–∏ (`/api/v5/orders`)
  - –ó–≤–æ–Ω–∫–∞–º–∏ (`/api/v5/telephony`)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Postman/curl

#### ‚úÖ **1.2 –ê–Ω–∞–ª–∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã**
**–£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å:**
- ‚úÖ `asterisk.py` - API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤–æ–Ω–∫–∞–º–∏ (–ø–æ—Ä—Ç 8018)
- ‚úÖ PostgreSQL —Å –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ API endpoints: `/api/makecallexternal`, `/api/monitor`, `/api/transfer`
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `clientId`

**–ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞:**
- [ ] Webhook endpoint –¥–ª—è –ø—Ä–∏–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –æ—Ç RetailCRM
- [ ] –ú–µ—Ç–æ–¥—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏
- [ ] –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤/–ª–∏–¥–æ–≤ –ø—Ä–∏ –Ω–æ–≤—ã—Ö –∑–≤–æ–Ω–∫–∞—Ö

---

### üîß **–≠–¢–ê–ü 2: –†–ê–ó–†–ê–ë–û–¢–ö–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ò (3-5 –¥–Ω–µ–π)**

#### ‚úÖ **2.1 –°–æ–∑–¥–∞–Ω–∏–µ RetailCRM Service**
```python
# retailcrm_service.py
class RetailCRMService:
    def __init__(self, api_url, api_key):
        self.api_url = api_url
        self.api_key = api_key
    
    async def create_customer(self, phone, name=None):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ RetailCRM"""
        
    async def create_order(self, customer_id, products=None):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞"""
        
    async def log_call(self, phone, duration, call_type):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–≤–æ–Ω–∫–∞"""
        
    async def search_customer_by_phone(self, phone):
        """–ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞"""
```

#### ‚úÖ **2.2 –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ asterisk.py**
```python
# –î–æ–±–∞–≤–∏—Ç—å –≤ asterisk.py
@app.post("/retailcrm/webhook")
async def handle_retailcrm_webhook(request):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤ –æ—Ç RetailCRM"""
    
@app.get("/api/makecallexternal")
async def make_call_with_crm_integration(code, phone, clientId):
    """–ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ CRM"""
    # 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å clientId
    # 2. –ù–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ –≤ RetailCRM –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
    # 3. –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –∑–≤–æ–Ω–æ–∫ —á–µ—Ä–µ–∑ SSH
    # 4. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–≤–æ–Ω–æ–∫ –≤ RetailCRM
```

#### ‚úÖ **2.3 Webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**
```python
# –°–æ–±—ã—Ç–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:
WEBHOOK_EVENTS = [
    "call.incoming",      # –í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫
    "call.outgoing",      # –ò—Å—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫
    "call.answered",      # –ó–≤–æ–Ω–æ–∫ –æ—Ç–≤–µ—á–µ–Ω
    "call.finished",      # –ó–≤–æ–Ω–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω
    "call.missed",        # –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –∑–≤–æ–Ω–æ–∫
]
```

---

### üìä **–≠–¢–ê–ü 3: –§–£–ù–ö–¶–ò–û–ù–ê–õ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò (2-3 –¥–Ω—è)**

#### ‚úÖ **3.1 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤**
- [ ] –ü—Ä–∏ –≤—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ –æ—Ç –Ω–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ ‚Üí —Å–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –≤ RetailCRM
- [ ] –ü—Ä–∏ –∏—Å—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ –Ω–∞ –Ω–æ–≤—ã–π –Ω–æ–º–µ—Ä ‚Üí —Å–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ ID –∫–ª–∏–µ–Ω—Ç–∞ –≤ RetailCRM

#### ‚úÖ **3.2 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤**
```json
// –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–≤–æ–Ω–∫–∞ –¥–ª—è RetailCRM
{
  "phone": "+375296254070",
  "type": "outgoing",
  "status": "completed",
  "duration": 120,
  "date": "2025-08-03 14:30:00",
  "employee": "manager@company.com",
  "customer": 12345,
  "recording": "https://bot.vochi.by/recordings/call_123.mp3"
}
```

#### ‚úÖ **3.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º**
- [ ] Click-to-call –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –≤ RetailCRM
- [ ] –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–≤–æ–Ω–∫–∞—Ö
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –≤—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ

---

### üîó **–≠–¢–ê–ü 4: WEBHOOK –°–ò–°–¢–ï–ú–ê (1-2 –¥–Ω—è)**

#### ‚úÖ **4.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ RetailCRM**
```json
// Webhook URL –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ RetailCRM
{
  "url": "https://bot.vochi.by/retailcrm/webhook",
  "events": [
    "customer.create",
    "customer.edit", 
    "order.create",
    "order.edit"
  ]
}
```

#### ‚úÖ **4.2 –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π**
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–∫–∞–∑–∞—Ö
- [ ] –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

---

## üìã **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø**

### üîß **–ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

#### **1. RetailCRM Service (retailcrm.py)**
```bash
# –ü–æ—Ä—Ç: 8019
# –§—É–Ω–∫—Ü–∏–∏:
# - API –∫–ª–∏–µ–Ω—Ç –¥–ª—è RetailCRM
# - Webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
# - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```

#### **2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ asterisk.py**
```python
# –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:
# - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å RetailCRM –ø—Ä–∏ –∑–≤–æ–Ω–∫–∞—Ö
# - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
# - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤ –≤ CRM
```

#### **3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
```sql
-- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–≤—è–∑–∏ —Å RetailCRM
CREATE TABLE retailcrm_customers (
    id SERIAL PRIMARY KEY,
    phone VARCHAR(20) NOT NULL,
    retailcrm_customer_id INTEGER,
    enterprise_number VARCHAR(10),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

#### **4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
```python
# retailcrm_config.py
RETAILCRM_CONFIG = {
    "api_url": "https://your-store.retailcrm.ru/api/v5",
    "api_key": "your-api-key",
    "webhook_secret": "webhook-secret-key"
}
```

---

## üìà **–û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´**

### ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:**
- üéØ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤** –ø—Ä–∏ –Ω–æ–≤—ã—Ö –∑–≤–æ–Ω–∫–∞—Ö
- üìû **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–≤–æ–Ω–∫–æ–≤** –≤ –µ–¥–∏–Ω–æ–π CRM —Å–∏—Å—Ç–µ–º–µ
- üîÑ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∏–µ–π –∏ CRM
- üìä **–ï–¥–∏–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** –ø–æ –∑–≤–æ–Ω–∫–∞–º –∏ –ø—Ä–æ–¥–∞–∂–∞–º

### ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ UX:**
- üñ±Ô∏è **Click-to-call** –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ RetailCRM
- üîî **–í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ –∑–≤–æ–Ω–∫–∞—Ö
- üìã **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫** –∫–ª–∏–µ–Ω—Ç–æ–≤
- üéµ **–ó–∞–ø–∏—Å–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤** –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ CRM

### ‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:**
- üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–≤–æ–Ω–∫–æ–≤** –ø–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
- üí∞ **–ö–æ–Ω–≤–µ—Ä—Å–∏—è –∑–≤–æ–Ω–∫–æ–≤ –≤ –ø—Ä–æ–¥–∞–∂–∏**
- ‚è±Ô∏è **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤**
- üìä **–û—Ç—á–µ—Ç—ã –ø–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**

---

## üõ†Ô∏è **–ü–õ–ê–ù –†–ê–ó–†–ê–ë–û–¢–ö–ò**

### **–ù–µ–¥–µ–ª—è 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- –î–µ–Ω—å 1-2: –ò–∑—É—á–µ–Ω–∏–µ RetailCRM API, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- –î–µ–Ω—å 3-4: –°–æ–∑–¥–∞–Ω–∏–µ `retailcrm_service.py`
- –î–µ–Ω—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π API

### **–ù–µ–¥–µ–ª—è 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ –∑–≤–æ–Ω–∫–∞–º–∏**  
- –î–µ–Ω—å 1-2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ `asterisk.py` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å RetailCRM
- –î–µ–Ω—å 3-4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- –î–µ–Ω—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∑–≤–æ–Ω–∫–æ–≤

### **–ù–µ–¥–µ–ª—è 3: Webhook —Å–∏—Å—Ç–µ–º–∞**
- –î–µ–Ω—å 1-2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤ –≤ RetailCRM
- –î–µ–Ω—å 3-4: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ—Ç CRM
- –î–µ–Ω—å 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–ù–µ–¥–µ–ª—è 4: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è**
- –î–µ–Ω—å 1-2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ `all.sh` –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –î–µ–Ω—å 3-4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- –î–µ–Ω—å 5: –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

---

## üîê **–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨**

### ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
- [ ] API –∫–ª—é—á–∏ RetailCRM –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è webhook secret –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ `clientId` –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚úÖ **–î–∞–Ω–Ω—ã–µ:**
- [ ] –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∞—É–¥–∏—Ç–∞
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìö **–ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò**

### üîó **RetailCRM:**
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API v5](https://docs.retailcrm.ru/Developers/API)
- [–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–µ—Ç–æ–¥–æ–≤](https://docs.retailcrm.ru/Developers/API/ApiVersions/Version5)
- [–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π](https://docs.retailcrm.ru/Developers/Integration)

### üîó **–ù–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞:**
- [asterisk.md](./asterisk.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Asterisk —Å–µ—Ä–≤–∏—Å–∞
- [auth_telegram.md](./auth_telegram.md) - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- PostgreSQL –±–∞–∑–∞: `enterprises`, `users` —Ç–∞–±–ª–∏—Ü—ã

---

## üìù **–ò–°–¢–û–†–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô**

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞       | –ò–∑–º–µ–Ω–µ–Ω–∏—è                                |
|--------|------------|------------------------------------------|
| 1.0    | 03.08.2025 | –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ –ø–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ |

---

## üéØ **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò**

1. **–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç RetailCRM** –∏ –ø–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á–∏
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –º–µ—Ç–æ–¥—ã** —á–µ—Ä–µ–∑ Postman 
3. **–°–æ–∑–¥–∞—Ç—å `retailcrm_service.py`** —Å –±–∞–∑–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å `asterisk.py`** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–≤–æ–Ω–∫–æ–≤
5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook'–∏** –¥–ª—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

---

*–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.*