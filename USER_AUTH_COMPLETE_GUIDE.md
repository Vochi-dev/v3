# üîê **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Vochi CRM**

## üìã **–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã**

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Vochi CRM –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ —á–µ—Ä–µ–∑ email + SMS –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Ä–æ–ª–µ–≤—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º.

## üéØ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π**

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ `bot.vochi.by`
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –Ω–∞ —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. **–í–≤–æ–¥ email** ‚Üí —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –Ω–∞ email + SMS
4. **–í–≤–æ–¥ –∫–æ–¥–∞** ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ cookie
5. **–ü–æ–ø–∞–¥–∞–Ω–∏–µ –Ω–∞ –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª** —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–µ–π
6. **–î–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º** —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã**

### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **Main Service** (–ø–æ—Ä—Ç 8000) - –æ—Å–Ω–æ–≤–Ω–æ–π FastAPI —Å–µ—Ä–≤–∏—Å —Å AuthMiddleware
- **Auth Service** (–ø–æ—Ä—Ç 8015) - –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **Desk Service** (–ø–æ—Ä—Ç 8011) - "–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª" —Å —Ä–æ–ª–µ–≤—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
- **Admin Service** (–ø–æ—Ä—Ç 8004) - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- **SMS Services** (–ø–æ—Ä—Ç—ã 8013, 8014) - –æ—Ç–ø—Ä–∞–≤–∫–∞ SMS –∫–æ–¥–æ–≤

### **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
- **`users`** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—è–º–∏
- **`auth_codes`** - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **`user_sessions`** - –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üîê **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**

### **1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤**
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./all.sh restart

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
./all.sh status

# –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
./auth.sh start
./desk.sh start
./admin.sh start
```

### **2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

#### **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:**
```sql
-- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã users —Ä–æ–ª—è–º–∏
ALTER TABLE users ADD COLUMN is_admin BOOLEAN DEFAULT FALSE;
ALTER TABLE users ADD COLUMN is_employee BOOLEAN DEFAULT TRUE;
ALTER TABLE users ADD COLUMN is_marketer BOOLEAN DEFAULT FALSE;
ALTER TABLE users ADD COLUMN is_spec1 BOOLEAN DEFAULT FALSE;
ALTER TABLE users ADD COLUMN is_spec2 BOOLEAN DEFAULT FALSE;

-- –¢–∞–±–ª–∏—Ü–∞ –∫–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
CREATE TABLE auth_codes (
    email VARCHAR(255) PRIMARY KEY,
    code VARCHAR(6) NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP DEFAULT NOW() + INTERVAL '10 minutes'
);

-- –¢–∞–±–ª–∏—Ü–∞ —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE user_sessions (
    session_token VARCHAR(255) PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id),
    enterprise_number VARCHAR(10) NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP DEFAULT NOW() + INTERVAL '24 hours'
);

CREATE INDEX idx_user_sessions_expires ON user_sessions(expires_at);
```

### **3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ä–≤–∏—Å–æ–≤**

#### **Auth Service (–ø–æ—Ä—Ç 8015):**
```python
CODE_LENGTH = 6                    # –î–ª–∏–Ω–∞ –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
CODE_EXPIRY_MINUTES = 10          # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–æ–¥–∞ (–º–∏–Ω—É—Ç—ã)
SESSION_EXPIRY_HOURS = 24         # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å–µ—Å—Å–∏–∏ (—á–∞—Å—ã)
```

#### **AuthMiddleware –≤ Main Service:**
```python
PUBLIC_ROUTES = {
    "/", "/admin", "/admin/login", "/admin/dashboard", "/admin/enterprises",
    "/health", "/docs", "/redoc", "/openapi.json",
    "/start", "/dial", "/bridge", "/hangup",  # Asterisk webhooks
    "/bridge_create", "/bridge_leave", "/bridge_destroy", "/new_callerid"
}
```

## üë• **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏**

### **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- **üü¢ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** (`is_admin=true`):
  - –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è
  - –ö–Ω–æ–ø–∫–∞ "üë§ –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" –≤ –†–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
  - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–æ–ª–∏

- **üü° –ú–∞—Ä–∫–µ—Ç–æ–ª–æ–≥** (`is_marketer=true`):
  - –î–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ
  - –ö–Ω–æ–ø–∫–∞ "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –≤ –†–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ

- **‚ö™ –°–æ—Ç—Ä—É–¥–Ω–∏–∫** (`is_employee=true`):
  - –ë–∞–∑–æ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ –†–∞–±–æ—á–µ–º—É —Å—Ç–æ–ª—É
  - –†–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

- **üîß Spec1/Spec2** (`is_spec1`, `is_spec2`):
  - –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–æ–ª–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
1. –ó–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è: `bot.vochi.by/admin/login`
2. –ü–µ—Ä–µ–π—Ç–∏ –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
3. –ù–∞–∂–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–±—Ä–∞—Ç—å —Ä–æ–ª–∏
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

### **–õ–æ–≥–∏–∫–∞ —Ä–æ–ª–µ–π:**
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** ‚Üí –æ—Ç–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–æ–ª–∏
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–æ–ª–∏** ‚Üí –º–æ–≥—É—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é** ‚Üí —Ä–æ–ª—å "–°–æ—Ç—Ä—É–¥–Ω–∏–∫"

## üåê **API Endpoints**

### **Auth Service (localhost:8015):**
```
GET  /                    - –°—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–≤–æ–¥–∞ email
POST /send-code          - –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
GET  /verify             - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞
POST /verify-code        - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
GET  /logout             - –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
GET  /health             - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞
```

### **Main Service (localhost:8000):**
```
GET  /                    - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ auth —Å–µ—Ä–≤–∏—Å
GET  /admin/*            - –ü—É–±–ª–∏—á–Ω—ã–µ –∞–¥–º–∏–Ω –º–∞—Ä—à—Ä—É—Ç—ã
POST /start, /dial, etc. - Asterisk webhooks (–ø—É–±–ª–∏—á–Ω—ã–µ)
```

### **Desk Service (localhost:8011):**
```
GET  /?enterprise=<name>&number=<num> - –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª —Å —Ä–æ–ª–µ–≤—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
GET  /health             - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```

## üîß **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤:**
1. –ó–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: `bot.vochi.by/admin/login`
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Service" –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
3. –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (stop/restart) —Å–µ—Ä–≤–∏—Å–∞–º–∏

### **–õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞:**
```bash
# –õ–æ–≥–∏ auth —Å–µ—Ä–≤–∏—Å–∞
tail -f /var/log/auth_service.log

# –õ–æ–≥–∏ main —Å–µ—Ä–≤–∏—Å–∞  
tail -f /var/log/main_service.log

# –õ–æ–≥–∏ desk —Å–µ—Ä–≤–∏—Å–∞
tail -f /var/log/desk_service.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ps aux | grep uvicorn

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
netstat -tlnp | grep -E '8000|8004|8011|8015'
```

### **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö –∫–æ–¥–æ–≤
DELETE FROM auth_codes WHERE expires_at < NOW();

-- –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π
DELETE FROM user_sessions WHERE expires_at < NOW();

-- –°–±—Ä–æ—Å –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
DELETE FROM user_sessions WHERE user_id = <user_id>;
```

## üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

### **–ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤:**
- **AuthMiddleware** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- **PUBLIC_ROUTES** —Å–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- **Session validation** –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–æ–≤
- **Automatic cleanup** —É–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏ –∞–¥–º–∏–Ω–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–ü–æ–ª–Ω—ã–π flow —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
curl -I http://localhost:8000/

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ auth —Å–µ—Ä–≤–∏—Å–∞
curl http://localhost:8015/health

# 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞
curl -X POST http://localhost:8015/send-code \
  -d "email=test@example.com"

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –≤ –ë–î
psql -h localhost -U postgres -d postgres \
  -c "SELECT * FROM auth_codes WHERE email='test@example.com';"

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏
curl --cookie "session_token=..." http://localhost:8011/
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π:**
1. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏
2. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–¥ –∫–∞–∂–¥—ã–º
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ –†–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
4. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–æ–≤

## üö® **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫**

### **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

**1. –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
sudo lsof -i :8015

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f /var/log/auth_service.log

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
./auth.sh restart
```

**2. –ö–æ–¥—ã –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SMS —Å–µ—Ä–≤–∏—Å (–ø–æ—Ä—Ç 8013)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ auth —Å–µ—Ä–≤–∏—Å–∞

**3. –°–µ—Å—Å–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è
- –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–µ—Å—Å–∏–∏

**4. –†–æ–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ desk —Å–µ—Ä–≤–∏—Å–∞
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å auth –∏ desk —Å–µ—Ä–≤–∏—Å—ã

## üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

### **–ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
```sql
-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
SELECT COUNT(*) FROM user_sessions WHERE expires_at > NOW();

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–æ–ª—è–º
SELECT 
    COUNT(*) as total,
    SUM(CASE WHEN is_admin THEN 1 ELSE 0 END) as admins,
    SUM(CASE WHEN is_marketer THEN 1 ELSE 0 END) as marketers,
    SUM(CASE WHEN is_employee THEN 1 ELSE 0 END) as employees
FROM users WHERE status = 'active';

-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
SELECT u.email, s.created_at, s.enterprise_number
FROM user_sessions s
JOIN users u ON s.user_id = u.id
ORDER BY s.created_at DESC LIMIT 10;
```

## üìù **Changelog**

### **v1.0.0 (–ê–≤–≥—É—Å—Ç 2025)**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ email + SMS
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω AuthMiddleware –¥–ª—è –∑–∞—â–∏—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Ä–æ–ª–µ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª
- ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## üîó **–°—Å—ã–ª–∫–∏**

- **–ì–ª–∞–≤–Ω–∞—è**: `https://bot.vochi.by/`
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: `https://bot.vochi.by/admin/login`
- **Auth —Å–µ—Ä–≤–∏—Å**: `http://localhost:8015/`
- **–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª**: `http://localhost:8011/`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API**: `http://localhost:8000/docs`

---

**üí° –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã.** 